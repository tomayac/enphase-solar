(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&e(a)}).observe(document,{childList:!0,subtree:!0});function n(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(t){if(t.ep)return;t.ep=!0;const r=n(t);fetch(t.href,r)}})();const ce="modulepreload",se=function(o){return"/"+o},K={},B=function(c,n,e){if(!n||n.length===0)return c();const t=document.getElementsByTagName("link");return Promise.all(n.map(r=>{if(r=se(r),r in K)return;K[r]=!0;const a=r.endsWith(".css"),p=a?'[rel="stylesheet"]':"";if(!!e)for(let u=t.length-1;u>=0;u--){const s=t[u];if(s.href===r&&(!a||s.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${p}`))return;const i=document.createElement("link");if(i.rel=a?"stylesheet":ce,a||(i.as="script",i.crossOrigin=""),i.href=r,document.head.appendChild(i),a)return new Promise((u,s)=>{i.addEventListener("load",u),i.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>c())};var O=function(o){var c={};function n(e){if(c[e])return c[e].exports;var t=c[e]={i:e,l:!1,exports:{}};return o[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}return n.m=o,n.c=c,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t||4&t&&typeof e=="object"&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&typeof e!="string")for(var a in e)n.d(r,a,function(p){return e[p]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(o,c,n){var e=n(2),t=n(3),r=n(4);o.exports=function(a){return e(a)||t(a)||r()}},function(o,c,n){n.r(c),n.d(c,"sparkline",function(){return q});var e=n(0),t=n.n(e);function r(i,u,s,g){return parseFloat((u-g*u/i+s).toFixed(2))}function a(i){return i.value}function p(i,u){var s=document.createElementNS("http://www.w3.org/2000/svg",i);for(var g in u)s.setAttribute(g,u[g]);return s}function q(i,u,s){var g;if(g=i,t()(g.querySelectorAll("*")).forEach(function(d){return g.removeChild(d)}),!(u.length<=1)){s=s||{},typeof u[0]=="number"&&(u=u.map(function(d){return{value:d}}));var A=s.onmousemove,F=s.onmouseout,Y="interactive"in s?s.interactive:!!A,w=s.spotRadius||2,x=2*w,Z=s.cursorWidth||2,P=parseFloat(i.attributes["stroke-width"].value),z=s.fetch||a,k=u.map(function(d){return z(d)}),Q=parseFloat(i.attributes.width.value)-2*x,_=parseFloat(i.attributes.height.value),H=_-2*P-x,$=Math.max.apply(Math,t()(k)),h=-1e3,G=k.length-1,ee=Q/G,b=[],te=r($,H,P+w,k[0]),j="M".concat(x," ").concat(te);k.forEach(function(d,y){var f=y*ee+x,v=r($,H,P+w,d);b.push(Object.assign({},u[y],{index:y,x:f,y:v})),j+=" L ".concat(f," ").concat(v)});var ne=p("path",{class:"sparkline--line",d:j,fill:"none"}),re=p("path",{class:"sparkline--fill",d:"".concat(j," V ").concat(_," L ").concat(x," ").concat(_," Z"),stroke:"none"});if(i.appendChild(re),i.appendChild(ne),Y){var S=p("line",{class:"sparkline--cursor",x1:h,x2:h,y1:0,y2:_,"stroke-width":Z}),E=p("circle",{class:"sparkline--spot",cx:h,cy:h,r:w});i.appendChild(S),i.appendChild(E);var M=p("rect",{width:i.attributes.width.value,height:i.attributes.height.value,style:"fill: transparent; stroke: transparent",class:"sparkline--interaction-layer"});i.appendChild(M),M.addEventListener("mouseout",function(d){S.setAttribute("x1",h),S.setAttribute("x2",h),E.setAttribute("cx",h),F&&F(d)}),M.addEventListener("mousemove",function(d){var y=d.offsetX,f=b.find(function(ie){return ie.x>=y});f||(f=b[G]);var v,L=b[b.indexOf(f)-1],N=(v=L?L.x+(f.x-L.x)/2<=y?f:L:f).x,oe=v.y;E.setAttribute("cx",N),E.setAttribute("cy",oe),S.setAttribute("x1",N),S.setAttribute("x2",N),A&&A(d,v)})}}}c.default=q},function(o,c){o.exports=function(n){if(Array.isArray(n)){for(var e=0,t=new Array(n.length);e<n.length;e++)t[e]=n[e];return t}}},function(o,c){o.exports=function(n){if(Symbol.iterator in Object(n)||Object.prototype.toString.call(n)==="[object Arguments]")return Array.from(n)}},function(o,c){o.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}}]);const U=document.querySelector(".consuming-value"),J=document.querySelector(".producing-value"),X=document.querySelector(".net-value"),R=document.querySelector(".producing-grid-animation"),I=document.querySelector(".grid-consuming-animation"),V=document.querySelector(".producing-consuming-animation"),W=document.querySelector(".exporting-or-importing"),me=document.querySelector(".pip-button"),ge=document.querySelector(".weblight-button"),he=document.querySelector(".live-container"),ye=document.querySelector(".live-section"),ue=document.querySelector(".producing-sparkline"),ae=document.querySelector(".consuming-sparkline"),le=document.querySelector(".importing-sparkline"),de=document.querySelector(".exporting-sparkline"),pe=60*5,l={producing:[],consuming:[],exporting:[],importing:[]};let m=!1;const T=o=>(o=Math.abs(o),o>=1e3?`${(o/1e3).toFixed(3)} kW`:`${Math.round(o)} W`),D=new EventSource("/stream/meter");D.addEventListener("error",o=>{console.error("Connection to event source at",o.target.url,"lost"),W.textContent="Grid",U.textContent="N/A",J.textContent="N/A",X.textContent="N/A",R.textContent="",I.textContent="",V.textContent="",m&&m(0,0,0),setTimeout(()=>{window.location.reload()},3e4)});D.addEventListener("open",o=>{console.log("Connected to event source at",o.target.url)});let C=!0;const fe=Object.keys(l);D.addEventListener("readings",o=>{C=!C;const c=JSON.parse(o.data),{producing:n,net:e,consuming:t}=c;fe.forEach(r=>{l[r].length>pe&&l[r].shift()}),l.producing.push(Math.round(n)),l.consuming.push(Math.round(t)),e<0?(l.exporting.push(Math.round(Math.abs(e))),l.importing.push(1e-5)):(l.exporting.push(1e-5),l.importing.push(Math.round(e))),U.textContent=T(t),J.textContent=T(n),X.textContent=T(e),O(ue,l.producing),O(ae,l.consuming),O(de,l.exporting),O(le,l.importing),n>0&&t>0?V.textContent="→":V.textContent="",n>0&&e<0?R.textContent="←":R.textContent="",e<0?(W.textContent="Exporting",I.textContent="",C&&m&&m(0,64,0)):(W.textContent="Importing",I.textContent="→",C&&m&&m(64,0,0)),C||m&&m(0,0,0)});"usb"in navigator&&(async()=>({setWebLightColor:m}=await B(()=>import("./weblight-6eff5455.js"),[])))();"wakeLock"in navigator&&B(()=>import("./wakelock-471e9300.js"),[]);"documentPictureInPicture"in window&&B(()=>import("./pip-c5d19ee9.js"),[]);"getDirectory"in navigator.storage&&new Worker("./sqlite-worker.js",{type:"module"});export{he as a,ye as l,me as p,ge as w};
